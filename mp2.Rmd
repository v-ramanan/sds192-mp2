---
title: "Mini Project 2"
author: "Vatsala, Emma, Margaret"
date: "3/8/2019"
output: html_document
---

```{r}
library(tidyverse)
```

```{r}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```


joining house elections and committees data frames by their common variable, the states and naming the new data frame

```{r}
join_df <- house_elections %>%
              left_join(committees, by=c("state"= "cmte_state"))
join_df
```

creating a new data frame that selects only the variable we want and filtering by new york, texas, and florida

note that we keep all three columns of voting because they all matter. 

```{r}
fec_df<- join_df %>%
      select(state, candidate_name, party, general_votes, incumbent, cmte_name)

fec_df
```

making a data frame from contributions that only contains negative contributions and filtering for ny, tx, and fl
```{r}
cont_neg <- contributions %>%
  select(name,transaction_amt,transaction_type, state)%>%
  filter(transaction_amt >0)
cont_neg
```
 doing the same as above but for positive contributions

```{r}
cont_neg_final <- fec_df %>%
    left_join(cont_neg, by = c("cmte_name" = "name"))%>%
    filter(!is.na(transaction_amt)) %>%
  group_by(state.x) %>%
  arrange(state.x)

  
 

cont_neg_final
```


```{r}
 edited_table<-cont_neg_final %>%
               select(state.x, candidate_name, party, general_votes, incumbent)
edited_table
```

```{r}
sum_money<-cont_neg_final%>%
  group_by(cmte_name)%>%
  summarize( sum_money = sum(transaction_amt))
sum_money
```

```{r}
neg_money<- cont_neg_final%>%
  left_join(sum_money, by = "cmte_name")%>%
  filter(transaction_type==c("24E", "24A"), state.x == "NY")%>%
  select(state.x, candidate_name, party, general_votes, incumbent, transaction_type, sum_money)%>%
  group_by(transaction_type, party)%>%
  summarise(new_sum=sum(sum_money))

neg_money
```

```{r}
money_plot <- ggplot(neg_money, aes(x = party, y = new_sum, fill = transaction_type))+
  geom_col(position = position_dodge())
money_plot

```

```{r}
neg_money_2 <- cont_neg_final %>%
  left_join(sum_money, by = "cmte_name") %>%
  filter(transaction_type== c("24A", "24E"), state.x == "NY") %>%
  select(state.x, party, general_votes, incumbent, candidate_name, cmte_name, transaction_amt, transaction_type, sum_money)

neg_money_2
```

```{r}
library(ggplot2)
```

```{r}
gen_votes_plot <- ggplot(neg_money_2, aes(x = party, y = general_votes, fill = transaction_type)) + geom_col(position = position_dodge())

gen_votes_plot
```






```{r}
plot <- ggplot(neg_money, aes(x = party, y = general_votes, fill = transaction_type)) + geom_col(position = position_dodge())

plot
```


#```{r}
cont_neg_join <- fec_df %>%
  left_join(cont_neg, by = c("cmte_name" = "name"))%>%
  filter(!is.na(transaction_amt))

cont_neg_join
```

make another data frame like above but for positive contributions

#```{r}
cont_pos_join <- fec_df %>%
  left_join(cont_pos, by = c("cmte_name" = "name"))%>%
    filter(!is.na(transaction_amt))
cont_pos_join
```
  
We picked the capital cities because in general it is reflective of the state's overall leanings. 
Austin
Tallahassee
albany

#```{r}
cont_pos <- contributions %>%
  select(name,transaction_amt, state)%>%
  filter(transaction_amt == "24A", state== c("NY", "TX", "FL"))
cont_pos
```
joining the negative contributions to the data set from before that contained housing elections and committees.  
we are looking at the total amount of money they got for them, not against their opponents. 

Young, C.W . Bill FL
Buchanan, Vern

Tonko, Paul D. NY
Maloney, Carolyn B.

Heaster, Dave WI
Boland, Ray


, candidate_name==c("Young, C.W . Bill", "Buchanan, Vern", "Tonko, Paul D.", "Maloney, Carolyn B.", "Heaster, Dave", "Boland, Ray"))

